<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Split the Nota - Restaurant Bill Splitter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #66e8ea 0%, #a2a04b 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
            min-height: 700px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            text-align: center;
        }

        p {
            color: #666;
            margin-bottom: 20px;
            text-align: center;
        }

        button {
            background: linear-gradient(135deg, #009688 0%, #3F51B5 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            display: block;
        }

        #resultOnPageContent:empty::after {
            content: "Inga resultat att visa";
            display: block;
            color: #999;
            font-style: italic;
            padding: 20px;
            text-align: center;
        }

        .result h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .result-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-left: 4px solid #667eea;
            border-radius: 4px;
        }

        .result-item strong {
            color: #667eea;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
        }

        .modal-content h2 {
            color: #333;
            margin-bottom: 15px;
        }

        .modal-content p {
            color: #666;
            margin-bottom: 20px;
            text-align: left;
        }

        .close-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        #resultInModal {
            min-height: 150px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üçΩÔ∏è Split the Nota</h1>
        <p>Dela upp restaurangnotan med dina v√§nner!</p>
        
        <button onclick="startSplitBill()">Starta Ber√§kning</button>
        <button onclick="startWithDefaults()">Anv√§nd Standardv√§rden</button>
        <button id="clearResultsBtn" onclick="clearResults()" style="background: #6c757d; display: none;">Rensa Resultat</button>
        
        <!-- Resultat-div som visas p√• sidan (inte i modal) -->
        <div id="resultOnPage" class="result">
            <h2>üí∞ Resultat</h2>
            <div id="resultOnPageContent"></div>
        </div>
    </div>

    <!-- Modal f√∂r resultat -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h2>üí∞ Ber√§kning Klar!</h2>
            <!-- Resultat-div som visas i modal -->
            <div id="resultInModal"></div>
            <button class="close-btn" onclick="closeModal()">St√§ng</button>
        </div>
    </div>

    <script>
        // ============================================
        // LOGGING KONFIGURATION
        // ============================================
        // S√§tt till true f√∂r att visa loggar i DevTools (development mode)
        // S√§tt till false f√∂r att d√∂lja loggar (production mode)
        const DEBUG_LOGS_ENABLED = true; // √Ñndra till false f√∂r production
        
        // Wrapper-funktion f√∂r console.log som bara loggar om DEBUG_LOGS_ENABLED √§r true
        function debugLog(...args) {
            if (DEBUG_LOGS_ENABLED) {
                console.log(...args);
            }
        }
        
        // Wrapper f√∂r console.error (f√∂r felmeddelanden)
        function debugError(...args) {
            if (DEBUG_LOGS_ENABLED) {
                console.error(...args);
            }
        }
        
        // Visa status n√§r sidan laddas
        debugLog("üçΩÔ∏è Split the Nota - Sidan laddad!");
        debugLog("üìä Debug-loggning:", DEBUG_LOGS_ENABLED ? "AKTIVERAD (Development)" : "INAKTIVERAD (Production)");
        debugLog("üí° √Ñndra DEBUG_LOGS_ENABLED f√∂r att v√§xla mellan development och production");
        
        // Standardv√§rden
        // OBS: Dessa √§r const defaults som inte √•tertilldelas.
        // Anv√§ndarens inmatning "√∂verskrider" dem vid k√∂rning via NYA variabler,
        // vi ers√§tter allts√• inte sj√§lva default-konstanterna.
        const DEFAULT_TOTAL_SUMMA = 500;
        const DEFAULT_ANTAL_VANNER = 4;
        const DEFAULT_DRICKS_PROCENT = 0.15; // 15%

        debugLog("üìã Standardv√§rden:", {
            totalSumma: DEFAULT_TOTAL_SUMMA,
            antalVanner: DEFAULT_ANTAL_VANNER,
            dricksProcent: DEFAULT_DRICKS_PROCENT * 100 + "%"
        });

        // Huvudfunktion f√∂r att dela upp notan
        function splitBill(totalSumma, antalVanner, dricksProcent) {
            debugLog("üî¢ splitBill() anropad med:", {
                totalSumma: totalSumma,
                antalVanner: antalVanner,
                dricksProcent: dricksProcent * 100 + "%"
            });
            
            // Ber√§kningar
            const dricksBelopp = totalSumma * dricksProcent;
            const summaMedDricks = totalSumma + dricksBelopp;
            const attBetalaPerPerson = summaMedDricks / antalVanner;

            debugLog("‚ûó Ber√§kningar:");
            debugLog("  - Dricksbelopp:", dricksBelopp.toFixed(2), "kr");
            debugLog("  - Summa med dricks:", summaMedDricks.toFixed(2), "kr");
            debugLog("  - Per person:", attBetalaPerPerson.toFixed(2), "kr");

            // Returnera resultat som objekt
            return {
                totalSumma: totalSumma,
                dricksProcent: dricksProcent * 100,
                dricksBelopp: dricksBelopp,
                summaMedDricks: summaMedDricks,
                antalVanner: antalVanner,
                attBetalaPerPerson: attBetalaPerPerson
            };
        }

        // Funktion f√∂r att visa resultat i modal
        function showResult(result) {
            debugLog("üéØ showResult() - Visar resultat i modal");
            debugLog("üìä Resultatobjekt:", result);
            
            const modal = document.getElementById('modal');
            const resultInModal = document.getElementById('resultInModal');
            
            // Formatera resultatet
            const html = `
                <p><strong>Total summa:</strong> ${result.totalSumma.toFixed(2)} kr</p>
                <p><strong>Dricks (${result.dricksProcent}%):</strong> ${result.dricksBelopp.toFixed(2)} kr</p>
                <p><strong>Summa med dricks:</strong> ${result.summaMedDricks.toFixed(2)} kr</p>
                <p><strong>Antal v√§nner:</strong> ${result.antalVanner}</p>
                <p><strong style="color: #667eea; font-size: 18px;">Varje v√§n ska betala: ${result.attBetalaPerPerson.toFixed(2)} kr</strong></p>
            `;
            
            resultInModal.innerHTML = html;
            modal.classList.add('show');
            debugLog("‚úÖ Modal visas nu");
        }

        // Funktion f√∂r att visa resultat i result-div p√• sidan
        function showResultInDiv(result) {
            debugLog("üìÑ showResultInDiv() - Visar resultat i div");
            const resultOnPage = document.getElementById('resultOnPage');
            const resultOnPageContent = document.getElementById('resultOnPageContent');
            
            const html = `
                <div class="result-item">
                    <strong>Total summa:</strong> ${result.totalSumma.toFixed(2)} kr
                </div>
                <div class="result-item">
                    <strong>Dricks (${result.dricksProcent}%):</strong> ${result.dricksBelopp.toFixed(2)} kr
                </div>
                <div class="result-item">
                    <strong>Summa med dricks:</strong> ${result.summaMedDricks.toFixed(2)} kr
                </div>
                <div class="result-item">
                    <strong>Antal v√§nner:</strong> ${result.antalVanner}
                </div>
                <div class="result-item" style="background: #e8f0ff; border-left-color: #667eea;">
                    <strong style="font-size: 18px;">Varje v√§n ska betala: ${result.attBetalaPerPerson.toFixed(2)} kr</strong>
                </div>
            `;
            
            resultOnPageContent.innerHTML = html;
            
            // Visa "Rensa Resultat"-knappen n√§r resultat visas
            document.getElementById('clearResultsBtn').style.display = 'block';
            
            debugLog("‚úÖ Resultat-div p√• sidan visas nu");
        }

        // Funktion f√∂r att st√§nga modal
        function closeModal() {
            debugLog("‚ùå closeModal() - St√§nger modal");
            document.getElementById('modal').classList.remove('show');
        }

        // Funktion f√∂r att rensa alla resultat
        function clearResults() {
            debugLog("üßπ clearResults() - Rensar alla resultat");
            
            // Rensa inneh√•llet p√• sidan
            const resultOnPage = document.getElementById('resultOnPage');
            const resultOnPageContent = document.getElementById('resultOnPageContent');
            resultOnPageContent.innerHTML = '';
            
            // Rensa inneh√•llet i modal
            const resultInModal = document.getElementById('resultInModal');
            resultInModal.innerHTML = '';
            
            // St√§ng modal om den √§r √∂ppen
            const modal = document.getElementById('modal');
            modal.classList.remove('show');
            
            // G√∂m "Rensa Resultat"-knappen n√§r resultaten √§r rensade
            document.getElementById('clearResultsBtn').style.display = 'none';
            
            debugLog("‚úÖ Alla resultat rensade");
        }

        // Funktion f√∂r att starta med prompt
        function startSplitBill() {
            debugLog("üöÄ startSplitBill() - Funktion startad");
            // Rensa tidigare resultat innan ny ber√§kning
            clearResults();
            
            // H√§mta input fr√•n anv√§ndaren med prompt()
            const totalSummaInput = prompt(
                `Ange total summa p√• notan (kr):`,
                DEFAULT_TOTAL_SUMMA
            );
            
            // Avbryt om anv√§ndaren trycker Cancel
            if (totalSummaInput === null) {
                debugLog("‚ö†Ô∏è Anv√§ndaren avbr√∂t - Total summa");
                return;
            }
            
            const antalVannerInput = prompt(
                `Ange antal v√§nner som delar notan:`,
                DEFAULT_ANTAL_VANNER
            );
            
            if (antalVannerInput === null) {
                debugLog("‚ö†Ô∏è Anv√§ndaren avbr√∂t - Antal v√§nner");
                return;
            }
            
            const dricksInput = prompt(
                `Ange dricks i procent (t.ex. 15 f√∂r 15%):`,
                DEFAULT_DRICKS_PROCENT * 100
            );
            
            if (dricksInput === null) {
                debugLog("‚ö†Ô∏è Anv√§ndaren avbr√∂t - Dricks");
                return;
            }
            
            debugLog("üì• Input fr√•n anv√§ndaren:", {
                totalSummaInput: totalSummaInput,
                antalVannerInput: antalVannerInput,
                dricksInput: dricksInput
            });
            
            // Konvertera till nummer
            const totalSumma = parseFloat(totalSummaInput) || DEFAULT_TOTAL_SUMMA;
            const antalVanner = parseInt(antalVannerInput) || DEFAULT_ANTAL_VANNER;
            const dricksProcent = (parseFloat(dricksInput) || 15) / 100;
            
            debugLog("üîß Konverterade v√§rden:", {
                totalSumma: totalSumma,
                antalVanner: antalVanner,
                dricksProcent: dricksProcent * 100 + "%"
            });
            
            // Kontrollera att v√§rdena √§r giltiga
            if (totalSumma <= 0 || antalVanner <= 0 || dricksProcent < 0) {
                debugError("‚ùå Felaktiga v√§rden validerade:", {
                    totalSumma: totalSumma,
                    antalVanner: antalVanner,
                    dricksProcent: dricksProcent
                });
                alert("‚ùå Felaktiga v√§rden! Ange positiva tal.");
                return;
            }
            
            // Ber√§kna resultat
            const result = splitBill(totalSumma, antalVanner, dricksProcent);
            
            // Visa resultat b√•de i modal och div
            showResult(result);
            showResultInDiv(result);
            
            debugLog("‚ú® Ber√§kning klar!");
        }

        // Funktion f√∂r att anv√§nda standardv√§rden direkt
        function startWithDefaults() {
            debugLog("üöÄ startWithDefaults() - Anv√§nder standardv√§rden");
            // Rensa tidigare resultat innan ny ber√§kning
            clearResults();
            
            const result = splitBill(DEFAULT_TOTAL_SUMMA, DEFAULT_ANTAL_VANNER, DEFAULT_DRICKS_PROCENT);
            
            showResult(result);
            showResultInDiv(result);
            
            debugLog("‚ú® Ber√§kning med standardv√§rden klar!");
        }

        // St√§ng modal n√§r man klickar utanf√∂r
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                debugLog("üñ±Ô∏è Klick utanf√∂r modal - st√§nger");
                closeModal();
            }
        }
        
        debugLog("‚úÖ Alla funktioner laddade och redo!");
    </script>
</body>
</html>
